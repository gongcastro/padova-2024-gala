```{r setup}
library(tibble)
library(tidyr)
library(ggplot2)
library(ggdist)
library(dplyr)
library(patchwork)
library(praatpicture)
library(showtext)

font_add_google("Fira Code", "fira")

html_tag_audio <- function(file, type = c("wav")) {
  type <- match.arg(type)
  htmltools::tags$audio(
    controls = "",
    htmltools::tags$source(
      src = file,
      type = glue::glue("audio/{type}", type = type)
    )
  )
}
```


## Why only us?

::: columns
:::: {.column width=65%}

* Humans develop linguistic abilities unparalelled to non-human animals
* Some animals show certain ability to process some aspects of language [e.g., @toro2016something]

::::
:::: {.column width=35%}
[![](assets/why-only-us.jpg){width=50%}](https://mitpress.mit.edu/9780262533492/why-only-us/)
::::
:::

::: box
**Gates to Language (GALA) ERC project (Chiara Santolin)**:

Are common mechanisms the entry gate to human language acquisition?
:::

## Syllable: a biologically meaningful linguistic unit?

* The linguistic signal is continuous, and must be **segmented** into relevant discrete units (e.g., phrases, words, syllables)
* Newborns (and adults) preferentially parse the speech signal into syllable-sized units [@bijeljac19934; @flo2022sleeping; @luo2007phase; @jusczyk1987representation; @bertoncini1988investigation]

## Syllabic structure

::: {.columns}
::: {.column}
![](assets/structure.png)
:::
::: {.column}
|Structure |Onset  |Nucleus  |Coda  |
|----------|-------|---------|------|
| CV       | t     |a        |      |
| CVC      | t     |a        |n     |
| VC       |       |a        |n     |
| V        |       |a        |      |
| CCCVCCCC |str    |e        |ngths |
:::
:::


## Language-specific phonotactics constrain syllabic structure

| Structure | Japanese     | Spanish          | English         |
|-----------|--------------|------------------|-----------------|
|V          | **u**.mi     | **o**.jo         | **a**.ny        |
|CV         | **ya**.ma.ha | **ca**.sa        | **fai**.ry      | 
|CVC        | **hon**.da   | **rin**.con      | **con**.trol    |
|CCVC       |              | **fres**.co      | **fresh**       |
|CCVCC      |              | **trans**.por.te | **shrink**      |
|CCVCCC     |              |                  | **struct**.ture |
|CCCVCCC    |              |                  | **strengths**   |

: Adapted from Özer (2024).


## Universal constraints to syllabic structure

Can you syllabify this word?

> /likla/

Which of these syllables sound good to you?

> /plick/ vs. /lpick/

## Syllable: a biologically meaningful linguistic unit?

* Two linguistic universals constrain syllabic structure:
    - **Maximal Onset Principle (MOP)** (research line 1)
    - **Sonority Sequencing Principle (SSP)** (research line 2)
* Do newborns use MOP and SSP to detect syllable boundaries?
* Are these mechanisms shared with non-human animals (Long-Evants rats)?

# Maximal Onset Principle (MOP)

Research line 1: neonates, infants

## Study 1: are newborns sensitive to (violations of) the MOP

Consonants are preferably grouped at syllable onset.

- MOP-compliant: CV.CCV ("pe.klo")  
- MOP-noncompliant: CVC.CV ("pok.lo")

## Participants

* ~50 healthy, hearing, full term neonates (crib testing)
* ~50 healthy, hearing, full term 6-10 mo infant(parents lap, watching cartoons)
* Mostly Catalan and/or Spanish linguistic background

## fNIRS setup

::: box
Estimating differences in concentration of oxy- and deoxy-hemoglobin in cortical regions of interest, as a proxy of neural activity in response to experimental manipulations.
:::

* NIRSport2 (NIRx), NIRScap
* Sampling frequency 20.345 Hz (~0.05 s samples)
* CW 760 nm & 850 nm
* 8 channels LH, 8 channels RH -> Bilateral temporal regions
* Crib testing

## Task design (fNIRS block design)

1. Familiarisation phase:
  - 10 blocks of words (20-22s silence between blocks)
  - 6 words different words in each block (0.5-1.5s silence between words)
2. Test phase:
  - 8 blocks of artificially segmented words: 2 Non-alt/SSP+, 2 Non-alt/SSP-, 4 Alt (20-22s silence between blocks)
  - 12 words different words in each block (0.5-1.5s silence between words)

---

![Familiarisation phase.](assets/fam-mop.png){width=100%}

---

![Test phase.](assets/test-mop.png){width=100%}


## Stimuli

::: box
**CVCCV words**: Onset + Consonant cluster (CC) + Vowel
:::

| Follows MOP (CV.CCV) | Violates MOP (CVC.CV)|
|-------------|--------------|
|pa.kla       |pak.la        |
|ro.tri       |rot.ri        |


## Stimuli

CV.CCV: 

- CC follows the Sonority Sequencing Principle (SSP)
- CC is phonotactical at onset in speakers' and participants' native language(s)

CVC.CV:

- C is phonotactical in coda in speakers' and participants' native language(s)

## Stimuli

Shortlisting words:

- Variability vs. repetition
- Generalisability


# Sonority Sequencing Principle (SSP)

Research line 2: neonates, infants, rats

## Study 1: are newborns sensitive to (violations of) the MOP

Syllables are predominantly a production unit: they result from a "single effort or impulse of the voice" [@whitney1874oriental].

> In a syllable, sonority increases toward the peak and decreases toward the margins [@morelli2003relative].

Most animal vocalisations follow this sonority pattern -> Evolutionary relevance -> Ancentral, inherited mechanism for perception?

```{r bran-audio}
html_tag_audio("assets/bran.wav", type = "wav")
```

```{r fig-ssp-bran}
#| label: fig-ssp-bran
#| fig-cap: "Sonority Sequencing Principle. Sonority values from @parker201149"
#| fig-height: 4
#| fig-width: 6
tribble(
  ~position, ~phoneme, ~sonority,
  "Onset", "b", 1,
  "Onset", "ɾ", 10,
  "Nucleus", "a", 17,
  "Coda", "n", 7
) |>
  mutate(phoneme = factor(phoneme, levels = phoneme, ordered = TRUE)) |>
  ggplot(aes(phoneme, sonority, fill = reorder(position, desc(position)))) +
  geom_col(colour = "white") +
  geom_line(aes(group = 1)) +
  labs(x = "Phoneme", y = "Sonority Index") +
  scale_fill_brewer(palette = "Reds") +
  theme_ggdist() +
  theme(
    legend.position = "top",
    axis.title.x = element_blank(),
    legend.title = element_blank(),
    plot.background = element_rect(fill = NA)
  )
```

## Sonority Sequencing Principle (SSP)

```{r fig-ssp-bran-grid}
#| label: fig-sspl-bran-grid
#| fig-cap: "Sonority profile of the syllable 'bran'"
praatpicture::praatpicture(
  "assets/bran.wav",
  intensity_plotOnSpec = TRUE,
  intensity_color = RColorBrewer::brewer.pal(3, "Reds")[2],
  font.axis = 2,
  spec_colors = RColorBrewer::brewer.pal(9, "Greys")[1:7],
  font = 2,
  pitch_freqRange = c(0, 700),
  proportion = c(50, 25, 25),
  family = "fira",
  lwd = 2,
  wave_color = RColorBrewer::brewer.pal(3, "Reds")[2],
)
```

## Sonority Sequencing Principle (SSP)

```{r fig-ssp-lbif}
#| label: fig-ssp-lbif
#| fig-cap: "Sonority Sequencing Principle. Sonority values from @parker201149"
tribble(
  ~position, ~phoneme, ~sonority,
  "Onset", "l", 9,
  "Onset", "b", 1,
  "Nucleus", "i", 15,
  "Coda", "f", 3
) |>
  mutate(phoneme = factor(phoneme, levels = phoneme, ordered = TRUE)) |>
  ggplot(aes(phoneme, sonority, fill = reorder(position, desc(position)))) +
  geom_col(colour = "white") +
  geom_line(aes(group = 1)) +
  labs(x = "Phoneme", y = "Sonority Index") +
  scale_fill_brewer(palette = "Reds") +
  theme_ggdist() +
  theme(
    legend.position = "top",
    axis.title.x = element_blank(),
    legend.title = element_blank(),
    plot.background = element_rect(fill = NA)
  )
```

## Sonority Sequencing Principle (SSP)

```{r fig-ssp-lbif-grid}
#| label: fig-sspl-lbif-grid
#| fig-cap: "Sonority profile of the syllable 'lbif'"
praatpicture::praatpicture(
  "assets/lbif.wav",
  intensity_plotOnSpec = TRUE,
  intensity_color = RColorBrewer::brewer.pal(3, "Reds")[2],
  font.axis = 2,
  spec_colors = RColorBrewer::brewer.pal(9, "Greys")[1:7],
  font = 2,
  pitch_freqRange = c(0, 700),
  proportion = c(50, 25, 25),
  family = "fira",
  lwd = 2,
  wave_color = RColorBrewer::brewer.pal(3, "Reds")[2],
)
```

## Participants

* ~50 healthy, hearing, full term neonates (crib testing)
* ~50 healthy, hearing, full term 4-5 mo infant(parents lap, watching cartoons)
* Mostly Catalan and/or Spanish linguistic background

## Task design (fNIRS block design)

1. Test phase:
  - 4 blocks of artificially segmented words: 1 Non-alt/SSP+, 1 Non-alt/SSP-, 2 Alt (20-22s silence between blocks)
  - 12 words different words in each block (0.5-1.5s silence between words)

---

![](assets/test-ssp.png){width=100%}

---



## Feedback/pending

## Thanks

